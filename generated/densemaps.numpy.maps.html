<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="densemaps.numpy.nn_utils" href="densemaps.numpy.nn_utils.html" /><link rel="prev" title="densemaps.numpy" href="densemaps.numpy.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>densemaps.numpy.maps - densemaps 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">densemaps 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">densemaps 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api.html">API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="densemaps.html">densemaps</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of densemaps</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current has-children"><a class="reference internal" href="densemaps.numpy.html">densemaps.numpy</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of densemaps.numpy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">densemaps.numpy.maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="densemaps.numpy.nn_utils.html">densemaps.numpy.nn_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="densemaps.numpy.point_to_triangle.html">densemaps.numpy.point_to_triangle</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="densemaps.torch.html">densemaps.torch</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of densemaps.torch</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="densemaps.torch.maps.html">densemaps.torch.maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="densemaps.torch.nn_utils.html">densemaps.torch.nn_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="densemaps.torch.point_to_triangle.html">densemaps.torch.point_to_triangle</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/generated/densemaps.numpy.maps.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-densemaps.numpy.maps">
<span id="densemaps-numpy-maps"></span><h1>densemaps.numpy.maps<a class="headerlink" href="#module-densemaps.numpy.maps" title="Link to this heading">¶</a></h1>
<p class="rubric">Classes</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#densemaps.numpy.maps.EmbKernelDenseDistMap" title="densemaps.numpy.maps.EmbKernelDenseDistMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EmbKernelDenseDistMap</span></code></a>(emb1, emb2[, blur, ...])</p></td>
<td><p>Kernel Map, computed from embeddings.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#densemaps.numpy.maps.EmbP2PMap" title="densemaps.numpy.maps.EmbP2PMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EmbP2PMap</span></code></a>(emb1, emb2[, n_jobs])</p></td>
<td><p>Point to point map, computed from embeddings.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#densemaps.numpy.maps.EmbPreciseMap" title="densemaps.numpy.maps.EmbPreciseMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EmbPreciseMap</span></code></a>(emb1, emb2, faces1[, n_jobs])</p></td>
<td><p>Point to barycentric map, computed from embeddings.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#densemaps.numpy.maps.KernelDenseDistMap" title="densemaps.numpy.maps.KernelDenseDistMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KernelDenseDistMap</span></code></a>(log_matrix[, lse_row, ...])</p></td>
<td><p>Map represented by a row-normalized dense matrix obtained from an element-wise exponential.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#densemaps.numpy.maps.P2PMap" title="densemaps.numpy.maps.P2PMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">P2PMap</span></code></a>(p2p_21[, n1])</p></td>
<td><p>Point to point map from a set S2 to a set S1.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap" title="densemaps.numpy.maps.PointWiseMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PointWiseMap</span></code></a>([array_names])</p></td>
<td><p>Root class representing a pointwise map.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#densemaps.numpy.maps.PreciseMap" title="densemaps.numpy.maps.PreciseMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PreciseMap</span></code></a>(v2face_21, bary_coords, faces1)</p></td>
<td><p>Point to barycentric map from a set S2 to a surface S1.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#densemaps.numpy.maps.SparseMap" title="densemaps.numpy.maps.SparseMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SparseMap</span></code></a>(map)</p></td>
<td><p>Map represented by a sparse matrix.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="densemaps.numpy.maps.PointWiseMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">densemaps.numpy.maps.</span></span><span class="sig-name descname"><span class="pre">PointWiseMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.PointWiseMap" title="Link to this definition">¶</a></dt>
<dd><p>Root class representing a pointwise map. Not supposed to be instanciated in itself.</p>
<p>A pointwise, denoted <span class="math notranslate nohighlight">\(P : S_2 \to S_1\)</span>, is a map that associates to each point x in <span class="math notranslate nohighlight">\(S_2\)</span> a point <span class="math notranslate nohighlight">\(P(x)\)</span> in <span class="math notranslate nohighlight">\(S_1\)</span>.
It can usually be represented as a <span class="math notranslate nohighlight">\(n_2 \times n_1\)</span> matrix, where <span class="math notranslate nohighlight">\(n_2\)</span> is the number of points in <span class="math notranslate nohighlight">\(S_2\)</span> and <span class="math notranslate nohighlight">\(n_1\)</span> the number of points in <span class="math notranslate nohighlight">\(S_1\)</span>.</p>
<p>Given a pointwise map <span class="math notranslate nohighlight">\(P\)</span>, the pullback of a function <span class="math notranslate nohighlight">\(f : S_1 \to R\)</span> is a function <span class="math notranslate nohighlight">\(f_{pb} : S_2 \to R\)</span> defined by <span class="math notranslate nohighlight">\(f_{pb}(x) = f(P(x))\)</span>.
In practice it can easily be computed by matrix multiplication: <span class="math notranslate nohighlight">\(f_{pb} = P f\)</span>.</p>
<p>In practice, we usually don’t need to use the exact values inside <span class="math notranslate nohighlight">\(P\)</span>, btu rather only care about multiplying with some functions,
extracting maximal values per-row or per-column, or summing on rows or columns.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="densemaps.numpy.maps.PointWiseMap.array_names">
<span class="sig-name descname"><span class="pre">array_names</span></span><a class="headerlink" href="#densemaps.numpy.maps.PointWiseMap.array_names" title="Link to this definition">¶</a></dt>
<dd><p>Names of the arrays stored in the object. Used to transfer to torch and to GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="densemaps.numpy.maps.PointWiseMap.pull_back">
<span class="sig-name descname"><span class="pre">pull_back</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.PointWiseMap.pull_back" title="Link to this definition">¶</a></dt>
<dd><p>Pull back a function <span class="math notranslate nohighlight">\(f\)</span>.
Three possibilities:</p>
<ol class="arabic simple">
<li><p>f is a function on S1, of shape (N1,), then the output is a function on S2, of shape (N2,)</p></li>
<li><p>f represents multiple function on S1, of shape (N1, p), then the output is a function on S2, of shape (N2, p)</p></li>
<li><p>f represents a batch multiple function on S1, of shape (B, N1, p), then the output is a function on S2, of shape (B, N2, p)</p></li>
</ol>
<p>Note tht the case where f is a batch of a single function (B, N1) is not supported, and one should then use <cite>f[…, None]</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>np.ndarray</em>) – (N1,), (N1, p) or (B, N1, p)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f_pb</strong> – (N2,), (N2, p) or (B, N2, p)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.PointWiseMap.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#densemaps.numpy.maps.PointWiseMap.shape" title="Link to this definition">¶</a></dt>
<dd><p>Shape of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> – Depends on the representation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.PointWiseMap.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#densemaps.numpy.maps.PointWiseMap.ndim" title="Link to this definition">¶</a></dt>
<dd><p>Number of dimensions of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ndim</strong> – Number of dimensions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="densemaps.numpy.maps.PointWiseMap.get_nn">
<span class="sig-name descname"><span class="pre">get_nn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.PointWiseMap.get_nn" title="Link to this definition">¶</a></dt>
<dd><p>Ouptputs the nearest neighbor map.
The nearest neighbor map is the map that associates to each point of S2 the index of the closest point in S1.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nn_map</strong> – (N2,) or (B, N2) depending on the representation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.PointWiseMap.mT">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mT</span></span><a class="headerlink" href="#densemaps.numpy.maps.PointWiseMap.mT" title="Link to this definition">¶</a></dt>
<dd><p>Returns the transpose of the map.</p>
<p>Returns the transpose of the matrix representation of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>map_t</strong> – Transpose map</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap" title="densemaps.numpy.maps.PointWiseMap">PointWiseMap</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="densemaps.numpy.maps.SparseMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">densemaps.numpy.maps.</span></span><span class="sig-name descname"><span class="pre">SparseMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.SparseMap" title="Link to this definition">¶</a></dt>
<dd><p>Map represented by a sparse matrix.</p>
<p>The sparse matrix is of size <cite>(N2, N1)</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>map</strong> (<em>scipy.sparse.csr_matrix</em>) – (N2, N1) or (N2, N1)</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.SparseMap.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#densemaps.numpy.maps.SparseMap.shape" title="Link to this definition">¶</a></dt>
<dd><p>Shape of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> – (N2, N1)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.SparseMap.mT">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mT</span></span><a class="headerlink" href="#densemaps.numpy.maps.SparseMap.mT" title="Link to this definition">¶</a></dt>
<dd><p>Returns the transpose of the map.</p>
<p>Returns the transpose of the matrix representation of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>map_t</strong> – Transpose map</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap" title="densemaps.numpy.maps.PointWiseMap">PointWiseMap</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="densemaps.numpy.maps.SparseMap.pull_back">
<span class="sig-name descname"><span class="pre">pull_back</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.SparseMap.pull_back" title="Link to this definition">¶</a></dt>
<dd><p>Pull back a function <span class="math notranslate nohighlight">\(f\)</span>.
Four possibilities:</p>
<ol class="arabic simple">
<li><p>f is a function on S1, of shape (N1,), then the output is a function on S2, of shape (N2,)</p></li>
<li><p>f represents multiple function on S1, of shape (N1, p), then the output is a function on S2, of shape (N2, p)</p></li>
<li><p>f represents a batch multiple function on S1, of shape (B, N1, p), then the output is a function on S2, of shape (B, N2, p)</p></li>
</ol>
<p>Note tht the case where f is a batch of a single function (B, N1) is not supported, and one should then use <cite>f[…, None]</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>np.ndarray</em>) – (N1,), (N1, p) or (B, N1, p)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f_pb</strong> – (N2,), (N2, p) or (B, N2, p)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="densemaps.numpy.maps.SparseMap.get_nn">
<span class="sig-name descname"><span class="pre">get_nn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.SparseMap.get_nn" title="Link to this definition">¶</a></dt>
<dd><p>Outputs the nearest neighbor map.
The nearest neighbor map is the map that associates to each point of S2 the index of the closest point in S1.
Simple argmax along the last dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nn_map</strong> – (N2,) on the representation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="densemaps.numpy.maps.P2PMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">densemaps.numpy.maps.</span></span><span class="sig-name descname"><span class="pre">P2PMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p2p_21</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.P2PMap" title="Link to this definition">¶</a></dt>
<dd><p>Point to point map from a set S2 to a set S1.
Defined by a map <span class="math notranslate nohighlight">\(P_{21} : S2 \to S1\)</span> or an array <cite>p2p_21</cite> of size <cite>(n_2)</cite>, where <cite>p2p_21[i]</cite> is the index of the point in S1 closest to the point i in S2.
Batched versions are accepted</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p2p_21</strong> (<em>(</em><em>n2</em><em>,</em><em>) or </em><em>(</em><em>B</em><em>, </em><em>n2</em><em>)</em>)</p></li>
<li><p><strong>n1</strong> (<em>int</em><em> or </em><em>None</em>) – Number of points in S1. If None, n1 = p2p.max()+1</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.P2PMap.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#densemaps.numpy.maps.P2PMap.shape" title="Link to this definition">¶</a></dt>
<dd><p>Shape of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> – returns (N2,) or (B, N2) depending on the representation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.P2PMap.n1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n1</span></span><a class="headerlink" href="#densemaps.numpy.maps.P2PMap.n1" title="Link to this definition">¶</a></dt>
<dd><p>Number of vertices on the first shape.
Estimated if not provided as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n1</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="densemaps.numpy.maps.P2PMap.pull_back">
<span class="sig-name descname"><span class="pre">pull_back</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.P2PMap.pull_back" title="Link to this definition">¶</a></dt>
<dd><p>Pull back a function <span class="math notranslate nohighlight">\(f\)</span>.
Four possibilities:</p>
<ol class="arabic simple">
<li><p>f is a function on S1, of shape (N1,), then the output is a function on S2, of shape (N2,) (or (B, N2,) if the map is batched)</p></li>
<li><p>f represents multiple function on S1, of shape (N1, p), then the output is a function on S2, of shape (N2, p) (or (B, N2, p) if the map is batched)</p></li>
<li><p>f represents a batch multiple function on S1, of shape (B, N1, p), then the output is a function on S2, of shape (B, N2, p)</p></li>
</ol>
<p>Note tht the case where f is a batch of a single function (B, N1) is not supported, and one should then use <cite>f[…, None]</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>np.ndarray</em>) – (N1,), (N1, p) or (B, N1, p)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f_pb</strong> – (N2,), (N2, p) or (B, N2, p)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="densemaps.numpy.maps.P2PMap.get_nn">
<span class="sig-name descname"><span class="pre">get_nn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.P2PMap.get_nn" title="Link to this definition">¶</a></dt>
<dd><p>Ouptputs the nearest neighbor map.
The nearest neighbor map is the same as the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nn_map</strong> – (N2,) or (B, N2) depending on the representation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.P2PMap.mT">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mT</span></span><a class="headerlink" href="#densemaps.numpy.maps.P2PMap.mT" title="Link to this definition">¶</a></dt>
<dd><p>Returns the transpose of the map.</p>
<p>Returns the transpose of the matrix representation of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>map_t</strong> – Transpose map</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap" title="densemaps.numpy.maps.PointWiseMap">PointWiseMap</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="densemaps.numpy.maps.PreciseMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">densemaps.numpy.maps.</span></span><span class="sig-name descname"><span class="pre">PreciseMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v2face_21</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bary_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.PreciseMap" title="Link to this definition">¶</a></dt>
<dd><p>Point to barycentric map from a set S2 to a surface S1.
Batched Version is not supported yet.</p>
<p>Is represented as a sparse matrix of size <cite>(N2, N1)</cite>, where there are at most 3 non-zero entries per row, which sum to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v2face_21</strong> (<em>np.ndarray</em>) – (n2,) Indices of the faces of S1 closest to each point of S2.</p></li>
<li><p><strong>bary_coords</strong> (<em>np.ndarray</em>) – (n2, 3) Barycentric coordinates of the points of S2 in the faces of S1.</p></li>
<li><p><strong>faces1</strong> (<em>np.ndarray</em>) – (N1, 3) All the Faces of S1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="densemaps.numpy.maps.EmbP2PMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">densemaps.numpy.maps.</span></span><span class="sig-name descname"><span class="pre">EmbP2PMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.EmbP2PMap" title="Link to this definition">¶</a></dt>
<dd><p>Point to point map, computed from embeddings.</p>
<p>Simple wrapper around P2PMap</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb1</strong> (<em>np.ndarray</em>) – (N1, p) or (B, N1, p)</p></li>
<li><p><strong>emb2</strong> (<em>np.ndarray</em>) – (N2, p) or (B, N2, p)</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – Number of jobs to use for the NN query</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="densemaps.numpy.maps.EmbPreciseMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">densemaps.numpy.maps.</span></span><span class="sig-name descname"><span class="pre">EmbPreciseMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.EmbPreciseMap" title="Link to this definition">¶</a></dt>
<dd><p>Point to barycentric map, computed from embeddings.</p>
<p>Simple wrapper around PreciseMap</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb1</strong> (<em>np.ndarray</em>) – (N1, K)</p></li>
<li><p><strong>emb2</strong> (<em>np.ndarray</em>) – (N2, K)</p></li>
<li><p><strong>faces1</strong> (<em>np.ndarray</em>) – (N1, 3)</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – Number of jobs to use for the NN query in the point_to_precise computation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="densemaps.numpy.maps.KernelDenseDistMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">densemaps.numpy.maps.</span></span><span class="sig-name descname"><span class="pre">KernelDenseDistMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lse_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lse_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.KernelDenseDistMap" title="Link to this definition">¶</a></dt>
<dd><p>Map represented by a row-normalized dense matrix obtained from an element-wise exponential.</p>
<p>The matrix is of size <cite>(N2, N1)</cite>, and has values <span class="math notranslate nohighlight">\(P_{ij} = \frac{1}{\sum_j \exp(D_{ij})} \exp(D_{ij})\)</span> where <span class="math notranslate nohighlight">\(D\)</span> is some matrix</p>
<p>Only D has to be provided</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_matrix</strong> (<em>np.ndarray</em>) – (N2, N1) or (B, N2, N1), the matrix D</p></li>
<li><p><strong>lse_row</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – (N2,) or (B, N2). The logsumexp on rows</p></li>
<li><p><strong>lse_col</strong> (<em>np.ndarray</em>) – (N1,) or (B, N1). The logsumexp on columns</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="densemaps.numpy.maps.KernelDenseDistMap.pull_back">
<span class="sig-name descname"><span class="pre">pull_back</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.KernelDenseDistMap.pull_back" title="Link to this definition">¶</a></dt>
<dd><p>Pull back a function <span class="math notranslate nohighlight">\(f\)</span>.
Four possibilities:</p>
<ol class="arabic simple">
<li><p>f is a function on S1, of shape (N1,), then the output is a function on S2, of shape (N2,)</p></li>
<li><p>f represents multiple function on S1, of shape (N1, p), then the output is a function on S2, of shape (N2, p)</p></li>
<li><p>f represents a batch multiple function on S1, of shape (B, N1, p), then the output is a function on S2, of shape (B, N2, p)</p></li>
</ol>
<p>Note tht the case where f is a batch of a single function (B, N1) is not supported, and one should then use <cite>f[…, None]</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>np.ndarray</em>) – (N1,), (N1, p) or (B, N1, p)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f_pb</strong> – (N2,), (N2, p) or (B, N2, p)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="densemaps.numpy.maps.KernelDenseDistMap.get_nn">
<span class="sig-name descname"><span class="pre">get_nn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.KernelDenseDistMap.get_nn" title="Link to this definition">¶</a></dt>
<dd><p>Outputs the nearest neighbor map.
The nearest neighbor map is the map that associates to each point of S2 the index of the closest point in S1.
Simple argmax along the last dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nn_map</strong> – (N2,) on the representation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.KernelDenseDistMap.mT">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mT</span></span><a class="headerlink" href="#densemaps.numpy.maps.KernelDenseDistMap.mT" title="Link to this definition">¶</a></dt>
<dd><p>Transposes the map.</p>
<p>Returns another KernelDenseDistMap object with the transposed matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>map_t</strong> – Transpose map</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#densemaps.numpy.maps.KernelDenseDistMap" title="densemaps.numpy.maps.KernelDenseDistMap">KernelDenseDistMap</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="densemaps.numpy.maps.KernelDenseDistMap.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#densemaps.numpy.maps.KernelDenseDistMap.shape" title="Link to this definition">¶</a></dt>
<dd><p>Shape of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> – Depends on the representation</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="densemaps.numpy.maps.EmbKernelDenseDistMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">densemaps.numpy.maps.</span></span><span class="sig-name descname"><span class="pre">EmbKernelDenseDistMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_emb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sqdist'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#densemaps.numpy.maps.EmbKernelDenseDistMap" title="Link to this definition">¶</a></dt>
<dd><p>Kernel Map, computed from embeddings.</p>
<p>Simple wrapper around KernelDenseDistMap.</p>
<p>Kernel has the form <span class="math notranslate nohighlight">\(\exp\big(-\frac{s(x,y)}{2\sigma^2}\big)\)</span>, where <span class="math notranslate nohighlight">\(s(x,y)\)</span> is either:
- the negative squared distance between the embeddings of x and y.
- the (positive) inner product between the embeddings of x and y (potentially normalized).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emb1</strong> (<em>np.ndarray</em>) – (N1, p) or (B, N1, p) embedding on first shape</p></li>
<li><p><strong>emb2</strong> (<em>np.ndarray</em>) – (N2, p) or (B, N2, p) embedding on second shape</p></li>
<li><p><strong>blur</strong> (<em>float</em>) – Standard deviation of the Gaussian kernel.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Normalize the blur by the maximum distance between embedding points</p></li>
<li><p><strong>normalize_emb</strong> (<em>bool</em>) – Normalize the embeddings.</p></li>
<li><p><strong>dist_type</strong> (<em>string</em>) – {“sqdist”, “inner”} Type of score to use.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="densemaps.numpy.nn_utils.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">densemaps.numpy.nn_utils</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="densemaps.numpy.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">densemaps.numpy</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Robin Magnet
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">densemaps.numpy.maps</a><ul>
<li><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap"><code class="docutils literal notranslate"><span class="pre">PointWiseMap</span></code></a><ul>
<li><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap.array_names"><code class="docutils literal notranslate"><span class="pre">PointWiseMap.array_names</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap.pull_back"><code class="docutils literal notranslate"><span class="pre">PointWiseMap.pull_back()</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap.shape"><code class="docutils literal notranslate"><span class="pre">PointWiseMap.shape</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap.ndim"><code class="docutils literal notranslate"><span class="pre">PointWiseMap.ndim</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap.get_nn"><code class="docutils literal notranslate"><span class="pre">PointWiseMap.get_nn()</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.PointWiseMap.mT"><code class="docutils literal notranslate"><span class="pre">PointWiseMap.mT</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#densemaps.numpy.maps.SparseMap"><code class="docutils literal notranslate"><span class="pre">SparseMap</span></code></a><ul>
<li><a class="reference internal" href="#densemaps.numpy.maps.SparseMap.shape"><code class="docutils literal notranslate"><span class="pre">SparseMap.shape</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.SparseMap.mT"><code class="docutils literal notranslate"><span class="pre">SparseMap.mT</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.SparseMap.pull_back"><code class="docutils literal notranslate"><span class="pre">SparseMap.pull_back()</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.SparseMap.get_nn"><code class="docutils literal notranslate"><span class="pre">SparseMap.get_nn()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#densemaps.numpy.maps.P2PMap"><code class="docutils literal notranslate"><span class="pre">P2PMap</span></code></a><ul>
<li><a class="reference internal" href="#densemaps.numpy.maps.P2PMap.shape"><code class="docutils literal notranslate"><span class="pre">P2PMap.shape</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.P2PMap.n1"><code class="docutils literal notranslate"><span class="pre">P2PMap.n1</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.P2PMap.pull_back"><code class="docutils literal notranslate"><span class="pre">P2PMap.pull_back()</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.P2PMap.get_nn"><code class="docutils literal notranslate"><span class="pre">P2PMap.get_nn()</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.P2PMap.mT"><code class="docutils literal notranslate"><span class="pre">P2PMap.mT</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#densemaps.numpy.maps.PreciseMap"><code class="docutils literal notranslate"><span class="pre">PreciseMap</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.EmbP2PMap"><code class="docutils literal notranslate"><span class="pre">EmbP2PMap</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.EmbPreciseMap"><code class="docutils literal notranslate"><span class="pre">EmbPreciseMap</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.KernelDenseDistMap"><code class="docutils literal notranslate"><span class="pre">KernelDenseDistMap</span></code></a><ul>
<li><a class="reference internal" href="#densemaps.numpy.maps.KernelDenseDistMap.pull_back"><code class="docutils literal notranslate"><span class="pre">KernelDenseDistMap.pull_back()</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.KernelDenseDistMap.get_nn"><code class="docutils literal notranslate"><span class="pre">KernelDenseDistMap.get_nn()</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.KernelDenseDistMap.mT"><code class="docutils literal notranslate"><span class="pre">KernelDenseDistMap.mT</span></code></a></li>
<li><a class="reference internal" href="#densemaps.numpy.maps.KernelDenseDistMap.shape"><code class="docutils literal notranslate"><span class="pre">KernelDenseDistMap.shape</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#densemaps.numpy.maps.EmbKernelDenseDistMap"><code class="docutils literal notranslate"><span class="pre">EmbKernelDenseDistMap</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=01f34227"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>